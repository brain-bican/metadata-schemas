{
    "$id": " ",
    "$schema": "https://json-schema.org/draft/2020-12/schema",

    "title": "Ephys Test Sweep metadata",
    "description": "Metadata collected from test sweep process stages of an IC electrophysiology acquisition recording during a Patch-seq experiment",
    "type": "object",
    "required": ["Session", "PREPARATION", "EXTPINBATH", "EXTPCllATT", "EXTPBREAKN", "EXTPEXPEND"],
    "properties": {
        "Session":{
            "type": "object",
            "description": "Metadata relevant to the entire recording session",
            "required": ["electrode_id", "device_id"],
            "properties": {
                "data": {"type":"string"},
                "description": {"type": "string"},
                "electrode_id": {"type": "string"},
                "device_id": {"type": "string"}
            }
        },
        "PREPARATION": {
            "type": "object",
            "title": "Preparation",
            "required": ["high_precision_sweep_start", "stimulus_description", "sweep_number"],
            "properties": {
                "RsComp_bandwidth": {"$ref": "#/$defs/RsComp_bandwidth"},
                "RsComp_correction": {"$ref": "#/$defs/RsComp_correction"},
                "RsComp_enable": {"$ref": "#/$defs/RsComp_enable"},
                "RsComp_prediction": {"$ref": "#/$defs/RsComp_prediction"},
                "whole_cell_comp_enable": {"$ref": "#/$defs/whole_cell_comp_enable"},
                "whole_cell_comp_cap": {"$ref": "#/$defs/whole_cell_comp_cap"},
                "whole_cell_comp_resist": {"$ref": "#/$defs/whole_cell_comp_resist"},
                "membrane_cap": {"$ref": "#/$defs/membrane_cap"},
                "series_resistance_enable": {"$ref": "#/$defs/series_resistance_enable"},
                "pipette_offset": {"$ref": "#/$defs/pipette_offset"},
                "capacitance_fast": {"$ref": "#/$defs/capacitance_fast"},
                "capacitance_slow ": {"$ref": "#/$defs/capacitance_slow"},
                "fast_compensation_capacitance": {"$ref": "#/$defs/fast_compensation_capacitance"},
                "slow_compensation_capacitance": {"$ref": "#/$defs/slow_compensation_capacitance"},
                "fast_compensation_time": {"$ref": "#/$defs/fast_compensation_time"},
                "slow_compensation_time": {"$ref": "#/$defs/slow_compensation_time"},
                "DA_gain": {"$ref": "#/$defs/DA_gain"},
                "AD_gain": {"$ref": "#/$defs/AD_gain"},
                "V-Clamp_holding_enable": {"$ref": "#/$defs/V-Clamp_holding_enable"},
                "V-Clamp_holding_level": {"$ref": "#/$defs/V-Clamp_holding_level"},
                "high_precision_sweep_start": {"$ref": "#/$defs/high_precision_sweep_start"},
                "bath_temperature": {"$ref": "#/$defs/bath_temperature"},
                "gain": {"$ref": "#/$defs/gain"},
                "offset": {"$ref": "#/$defs/offset"},
                "rate": {"$ref": "#/$defs/rate"},
                "resolution": {"$ref": "#/$defs/resolution"},
                "starting_time": {"$ref": "#/$defs/starting_time"},
                "starting_time_unit": {"$ref": "#/$defs/starting_time_unit"},
                "stimulus_description": {"$ref": "#/$defs/stimulus_description"},
                "sweep_number": {"$ref": "#/$defs/sweep_number"},
                "unit": {"$ref": "#/$defs/unit"}
            }
        },
        "EXTPINBATH": {
            "type": "object",
            "title": "In Bath",
            "required": ["high_precision_sweep_start", "stimulus_description", "sweep_number"],
            "properties": {
                "electrodeZeroedBiasCurrent_Enabled": {"$ref": "#/$defs/electrodeZeroedBiasCurrent_Enabled"},
                "high_precision_sweep_start": {"$ref": "#/$defs/high_precision_sweep_start"},
                "pipette_offset": {"$ref": "#/$defs/pipette_offset"},
                "rate": {"$ref": "#/$defs/rate"},
                "starting_time": {"$ref": "#/$defs/starting_time"},
                "starting_time_unit": {"$ref": "#/$defs/starting_time_unit"},
                "stimulus_description": {"$ref": "#/$defs/stimulus_description"},
                "sweep_number": {"$ref": "#/$defs/sweep_number"},
                "unit": {"$ref": "#/$defs/unit"}
            }
        },
        "EXTPCllATT": {
            "type": "object",
            "title": "Cell Attached",
            "required": ["high_precision_sweep_start", "stimulus_description", "sweep_number"],
            "properties": {
                "tightSealResistance": {"$ref": "#/$defs/tightSealResistance"},
                "V-Clamp_holding_enable": {"$ref": "#/$defs/V-Clamp_holding_enable"},
                "high_precision_sweep_start": {"$ref": "#/$defs/high_precision_sweep_start"},
                "rate": {"$ref": "#/$defs/rate"},
                "starting_time": {"$ref": "#/$defs/starting_time"},
                "starting_time_unit": {"$ref": "#/$defs/starting_time_unit"},
                "stimulus_description": {"$ref": "#/$defs/stimulus_description"},
                "sweep_number": {"$ref": "#/$defs/sweep_number"},
                "unit": {"$ref": "#/$defs/unit"}
            }
        },
        "EXTPBREAKN": {
            "type": "object",
            "title": "Whole Cell, beginning",
            "required": ["high_precision_sweep_start", "stimulus_description", "sweep_number"],
            "properties": {
                "restingMembranePotential": {"$ref": "#/$defs/restingMembranePotential"},
                "initialAccessResistance": {"$ref": "#/$defs/initialAccessResistance"},
                "inputResistance": {"$ref": "#/$defs/inputResistance"},
                "high_precision_sweep_start": {"$ref": "#/$defs/high_precision_sweep_start"},
                "rate": {"$ref": "#/$defs/rate"},
                "starting_time": {"$ref": "#/$defs/starting_time"},
                "starting_time_unit": {"$ref": "#/$defs/starting_time_unit"},
                "stimulus_description": {"$ref": "#/$defs/stimulus_description"},
                "sweep_number": {"$ref": "#/$defs/sweep_number"},
                "unit": {"$ref": "#/$defs/unit"}
            }
        },
        "EXTPRSCHEK": {
            "type": "object",
            "title": "Whole Cell, optional checkpoint",
            "properties": {}
        },
        "EXTPEXPEND": {
            "type": "object",
            "title": "Whole Cell, end",
            "required": ["high_precision_sweep_start", "stimulus_description", "sweep_number"],
            "properties": {
                "high_precision_sweep_start": {"$ref": "#/$defs/high_precision_sweep_start"},
                "rate": {"$ref": "#/$defs/rate"},
                "starting_time": {"$ref": "#/$defs/starting_time"},
                "starting_time_unit": {"$ref": "#/$defs/starting_time_unit"},
                "stimulus_description": {"$ref": "#/$defs/stimulus_description"},
                "sweep_number": {"$ref": "#/$defs/sweep_number"},
                "unit": {"$ref": "#/$defs/unit"}   
            }
        },
        "EXTPGGAEND": {
            "type": "object",
            "title": "After Pull-off",
            "properties": {}
        }
    },
    "additionalProperties": "",
    "$defs": {
        "capacitance_fast": {"type": "number"},
        "capacitance_slow ": {"type": "number"},
        "fast_compensation_capacitance": {"type": "number"},
        "slow_compensation_capacitance": {"type": "number"},
        "fast_compensation_time": {"type": "number"},
        "slow_compensation_time": {"type": "number"},
        "DA_gain": {"type": "number"},
        "AD_gain": {"type": "number"},
        "V-Clamp_holding_enable": {"type": "boolean"},
        "V-Clamp_holding_level": {"type": "number"},
        "RsComp_bandwidth": {"type": "number"},
        "RsComp_correction": {"type": "number"},
        "RsComp_enable": {"type": "boolean"},
        "RsComp_prediction": {"type": "number"},
        "whole_cell_comp_enable": {"type": "boolean"},
        "whole_cell_comp_cap": {"type": "number"},
        "whole_cell_comp_resist": {"type": "number"},
        "membrane_cap": {"type": "number"},
        "series_resistance_enable": {"type": "boolean"},
        "pipette_offset": {"type": "number"},
        "high_precision_sweep_start": {"type": "string", "format": "date-time"},
        "bath_temperature": {"type": "number"},
        "gain": {"type": "number"},
        "offset": {"type": "number"},
        "rate": {"type": "number"},
        "resolution": {"type": "string"},
        "starting_time": {"type": "number"},
        "starting_time_unit": {"type": "string"},
        "stimulus_description": {"type": "string"},
        "sweep_number":{"type": "integer"},
        "unit": {"type": "string"},
        "electrodeZeroedBiasCurrent_Enabled": {"type": "boolean"},
        "tightSealResistance": {"type": "number"},
        "restingMembranePotential": {"type": "number"},
        "initialAccessResistance": {"type": "number"},
        "inputResistance": {"type": "number"}
    }
}
